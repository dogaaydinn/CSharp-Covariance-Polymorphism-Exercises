# Changelog Automation Guide

## Overview

This guide covers automating changelog generation using various tools and techniques, following the Keep a Changelog format and Conventional Commits standard.

## Table of Contents

- [Keep a Changelog Format](#keep-a-changelog-format)
- [Automated Generation Tools](#automated-generation-tools)
- [git-cliff Configuration](#git-cliff-configuration)
- [conventional-changelog Setup](#conventional-changelog-setup)
- [GitHub Release Notes](#github-release-notes)
- [Migration Guides](#migration-guides)
- [Best Practices](#best-practices)

## Keep a Changelog Format

### Structure

```markdown
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added
- New features that have been added

### Changed
- Changes in existing functionality

### Deprecated
- Features that will be removed in upcoming releases

### Removed
- Features that have been removed

### Fixed
- Bug fixes

### Security
- Security improvements or vulnerability fixes

## [1.0.0] - 2025-01-15

### Added
- Initial release
- User authentication system
- REST API endpoints

### Changed
- Improved performance by 50%

### Fixed
- Fixed memory leak in background service

## [0.9.0] - 2024-12-01

### Added
- Beta release
- Core functionality

[Unreleased]: https://github.com/user/repo/compare/v1.0.0...HEAD
[1.0.0]: https://github.com/user/repo/compare/v0.9.0...v1.0.0
[0.9.0]: https://github.com/user/repo/releases/tag/v0.9.0
```

### Categories

| Category | Description | Examples |
|----------|-------------|----------|
| **Added** | New features | New APIs, new capabilities |
| **Changed** | Changes to existing features | API modifications, behavior changes |
| **Deprecated** | Soon-to-be removed features | Warnings about future removals |
| **Removed** | Removed features | Deleted APIs, removed functionality |
| **Fixed** | Bug fixes | Crash fixes, correctness improvements |
| **Security** | Security fixes | Vulnerability patches, security enhancements |

### Writing Good Changelog Entries

**Good Examples:**
```markdown
### Added
- User authentication with OAuth2 support for Google and GitHub
- RESTful API endpoints for user management (GET, POST, PUT, DELETE)
- Real-time notifications using SignalR
- Batch processing capability for large data imports

### Fixed
- Fixed null reference exception in UserService.GetUserById() (#123)
- Corrected timezone handling in date calculations (#456)
- Resolved memory leak in background job processor (#789)
```

**Bad Examples:**
```markdown
### Added
- Stuff
- Various improvements
- Updated code

### Fixed
- Bug fixes
- Some issues
```

## Automated Generation Tools

### Tool Comparison

| Tool | Language | Features | Best For |
|------|----------|----------|----------|
| **git-cliff** | Rust | Fast, regex-based, highly customizable | Large repos, complex rules |
| **conventional-changelog** | Node.js | Conventional Commits focused | JavaScript/TypeScript projects |
| **semantic-release** | Node.js | Full release automation | Automated releases |
| **GitVersion** | .NET | Version calculation + changelog | .NET projects |
| **github-changelog-generator** | Ruby | GitHub-specific | GitHub projects |

## git-cliff Configuration

### Installation

```bash
# Install via cargo (Rust)
cargo install git-cliff

# Or download binary from GitHub releases
# https://github.com/orhun/git-cliff/releases

# Or via package managers:
# macOS
brew install git-cliff

# Windows
scoop install git-cliff

# Linux
# Download from releases or build from source
```

### Configuration File

Create `cliff.toml` in project root:

```toml
[changelog]
# Changelog header
header = """
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n
"""

# Template for changelog body
body = """
{% if version %}\
    ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}\
    ## [Unreleased]
{% endif %}\
{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | upper_first }}
    {% for commit in commits %}
        - {% if commit.breaking %}[**BREAKING**] {% endif %}{{ commit.message | upper_first }}\
          {% if commit.github.pr_number %} ([#{{ commit.github.pr_number }}]({{ commit.github.pr_url }})){% endif %}\
    {% endfor %}
{% endfor %}\n
"""

# Changelog footer
footer = """
<!-- generated by git-cliff -->
"""

# Remove conventional commit prefixes from changelog entries
trim = true

[git]
# Parse commits based on conventional commit style
conventional_commits = true

# Filter commits based on regex
filter_commits = false

# Regex for preprocessing commit messages
commit_preprocessors = [
    { pattern = '\((\w+\s)?#([0-9]+)\)', replace = "([#${2}](https://github.com/dogaaydinn/CSharp-Covariance-Polymorphism-Exercises/issues/${2}))" },
]

# Regex for parsing and grouping commits
commit_parsers = [
    { message = "^feat", group = "Features" },
    { message = "^fix", group = "Bug Fixes" },
    { message = "^doc", group = "Documentation" },
    { message = "^perf", group = "Performance" },
    { message = "^refactor", group = "Refactoring" },
    { message = "^style", group = "Styling" },
    { message = "^test", group = "Testing" },
    { message = "^chore\\(release\\): prepare for", skip = true },
    { message = "^chore", group = "Miscellaneous Tasks" },
    { body = ".*security", group = "Security" },
]

# Protect breaking changes from being skipped
protect_breaking_commits = false

# Filter out commits that are not conventional
filter_unconventional = true

# Split commits by newlines
split_commits = false

# Sort by oldest first
sort_commits = "oldest"

[remote.github]
owner = "dogaaydinn"
repo = "CSharp-Covariance-Polymorphism-Exercises"
token = ""
```

### Usage

```bash
# Generate changelog from all commits
git cliff

# Generate for specific range
git cliff v1.0.0..HEAD

# Generate for latest version only
git cliff --latest

# Output to file
git cliff --output CHANGELOG.md

# Generate unreleased changes
git cliff --unreleased

# Prepend to existing changelog
git cliff --prepend CHANGELOG.md

# Tag and generate
git cliff --tag v1.1.0 --prepend CHANGELOG.md

# Include all commits (even unconventional)
git cliff --include-path "*" --all
```

### GitHub Actions Integration

```yaml
# .github/workflows/changelog.yml
name: Generate Changelog

on:
  push:
    tags:
      - 'v*'

jobs:
  changelog:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Generate Changelog
        uses: orhun/git-cliff-action@v2
        with:
          config: cliff.toml
          args: --latest --strip header
        env:
          OUTPUT: CHANGELOG_BODY.md

      - name: Update Changelog
        run: |
          git cliff --tag ${{ github.ref_name }} --prepend CHANGELOG.md
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add CHANGELOG.md
          git commit -m "docs: update CHANGELOG for ${{ github.ref_name }}"
          git push

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          body_path: CHANGELOG_BODY.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## conventional-changelog Setup

### Installation

```bash
# Install conventional-changelog-cli
npm install -g conventional-changelog-cli

# Or as dev dependency
npm install --save-dev conventional-changelog-cli
```

### Package.json Configuration

```json
{
  "scripts": {
    "changelog": "conventional-changelog -p angular -i CHANGELOG.md -s",
    "changelog:all": "conventional-changelog -p angular -i CHANGELOG.md -s -r 0"
  },
  "devDependencies": {
    "conventional-changelog-cli": "^4.1.0"
  }
}
```

### Usage

```bash
# Generate changelog (append)
npm run changelog

# Generate full changelog (regenerate all)
npm run changelog:all

# Generate for first release
conventional-changelog -p angular -i CHANGELOG.md -s -r 0

# Preview without writing
conventional-changelog -p angular

# Use custom preset
conventional-changelog -p conventionalcommits -i CHANGELOG.md -s
```

### Presets

| Preset | Description |
|--------|-------------|
| `angular` | Angular commit conventions |
| `atom` | Atom conventions |
| `conventionalcommits` | Conventional Commits spec |
| `ember` | Ember.js conventions |
| `eslint` | ESLint conventions |
| `jshint` | JSHint conventions |

### Custom Configuration

Create `.changelogrc`:

```json
{
  "types": [
    {"type": "feat", "section": "Features"},
    {"type": "fix", "section": "Bug Fixes"},
    {"type": "perf", "section": "Performance Improvements"},
    {"type": "docs", "section": "Documentation"},
    {"type": "style", "section": "Styles", "hidden": true},
    {"type": "refactor", "section": "Code Refactoring"},
    {"type": "test", "section": "Tests", "hidden": true},
    {"type": "build", "section": "Build System"},
    {"type": "ci", "section": "CI/CD", "hidden": true},
    {"type": "chore", "section": "Chores", "hidden": true}
  ],
  "issueUrlFormat": "https://github.com/user/repo/issues/{{id}}",
  "commitUrlFormat": "https://github.com/user/repo/commit/{{hash}}",
  "compareUrlFormat": "https://github.com/user/repo/compare/{{previousTag}}...{{currentTag}}",
  "userUrlFormat": "https://github.com/{{user}}"
}
```

## GitHub Release Notes

### Automatic Release Notes

GitHub can automatically generate release notes from pull requests:

```yaml
# .github/release.yml
changelog:
  exclude:
    labels:
      - ignore-for-release
    authors:
      - octocat
  categories:
    - title: Breaking Changes üõ†
      labels:
        - breaking-change
        - breaking
    - title: New Features üéâ
      labels:
        - feature
        - enhancement
    - title: Bug Fixes üêõ
      labels:
        - bug
        - fix
    - title: Performance Improvements ‚ö°
      labels:
        - performance
    - title: Documentation üìö
      labels:
        - documentation
    - title: Other Changes
      labels:
        - "*"
```

### Manual Release Creation

```yaml
# In release.yml workflow
- name: Create Release
  uses: softprops/action-gh-release@v1
  with:
    tag_name: ${{ github.ref }}
    name: Release ${{ github.ref_name }}
    body: |
      ## What's Changed

      ### Features
      - New authentication system
      - Enhanced caching layer

      ### Bug Fixes
      - Fixed memory leak in service
      - Corrected validation logic

      **Full Changelog**: https://github.com/${{ github.repository }}/compare/v1.0.0...v1.1.0
    draft: false
    prerelease: false
```

### Release Notes Template

```markdown
## üöÄ What's New in v{{ version }}

### ‚ú® Features
{{ features }}

### üêõ Bug Fixes
{{ bug_fixes }}

### ‚ö° Performance
{{ performance }}

### üìö Documentation
{{ documentation }}

### üîí Security
{{ security }}

## üì¶ Installation

### NuGet
```bash
dotnet add package AdvancedConcepts.Core --version {{ version }}
```

### Docker
```bash
docker pull ghcr.io/dogaaydinn/advancedconcepts:{{ version }}
```

## üîó Links

- **Documentation**: https://docs.example.com
- **Full Changelog**: {{ changelog_url }}
- **Migration Guide**: {{ migration_guide_url }}

## üë• Contributors

{{ contributors }}

---

**Note:** This release requires .NET 8.0 or later.
```

## Migration Guides

### Structure

```markdown
# Migration Guide: v1.x to v2.0

## Overview

This guide helps you migrate from v1.x to v2.0 of Advanced C# Concepts.

## Breaking Changes

### 1. Authentication API Redesign

**Impact:** High - All authentication code must be updated

**Before (v1.x):**
```csharp
var auth = new Authenticator();
auth.Login(username, password);
```

**After (v2.0):**
```csharp
var auth = new AuthenticationService();
await auth.AuthenticateAsync(new Credentials(username, password));
```

**Migration Steps:**
1. Replace `Authenticator` with `AuthenticationService`
2. Change synchronous calls to async
3. Use `Credentials` class instead of separate parameters

### 2. Configuration System

**Impact:** Medium - Configuration loading changed

**Before (v1.x):**
```csharp
var config = ConfigurationLoader.Load("appsettings.json");
```

**After (v2.0):**
```csharp
var config = new ConfigurationBuilder()
    .AddJsonFile("appsettings.json")
    .Build();
```

## Deprecated Features

The following features are deprecated and will be removed in v3.0:

| Feature | Alternative | Removal Version |
|---------|-------------|-----------------|
| `UserService.GetUser(int id)` | `UserService.GetUserAsync(int id)` | v3.0 |
| `Logger.Write(string)` | Use `ILogger` instead | v3.0 |

## New Features

### Enhanced Logging

```csharp
// New structured logging
_logger.LogInformation("User {UserId} logged in from {IpAddress}",
    userId, ipAddress);
```

### Performance Improvements

- 50% faster startup time
- 30% reduction in memory usage
- Improved LINQ query performance

## Migration Checklist

- [ ] Update NuGet package to v2.0.0
- [ ] Replace `Authenticator` with `AuthenticationService`
- [ ] Convert synchronous auth calls to async
- [ ] Update configuration loading code
- [ ] Replace deprecated `UserService.GetUser()` calls
- [ ] Update logging to use `ILogger`
- [ ] Run full test suite
- [ ] Update documentation

## Support

If you encounter issues during migration:

- Check [GitHub Issues](https://github.com/user/repo/issues)
- Read the [v2.0 Documentation](https://docs.example.com)
- Ask for help in [Discussions](https://github.com/user/repo/discussions)
```

## Best Practices

### 1. Changelog Maintenance

- ‚úÖ Update changelog with every release
- ‚úÖ Write user-facing descriptions
- ‚úÖ Link to issues and PRs
- ‚úÖ Group changes by type
- ‚úÖ Include breaking change warnings

### 2. Automation

- ‚úÖ Generate changelog automatically from commits
- ‚úÖ Validate conventional commits in CI
- ‚úÖ Auto-update changelog on release
- ‚úÖ Include changelog in GitHub releases
- ‚úÖ Test automation before production use

### 3. Content Quality

- ‚úÖ Focus on user impact, not implementation
- ‚úÖ Provide migration guidance for breaking changes
- ‚úÖ Include code examples
- ‚úÖ Link to detailed documentation
- ‚úÖ Thank contributors

### 4. Versioning

- ‚úÖ Follow semantic versioning strictly
- ‚úÖ Tag all releases
- ‚úÖ Include version in changelog
- ‚úÖ Maintain unreleased section
- ‚úÖ Compare links between versions

### 5. Distribution

- ‚úÖ Include changelog in package
- ‚úÖ Display in GitHub releases
- ‚úÖ Link from documentation
- ‚úÖ Announce major changes
- ‚úÖ Archive old versions

## Example Workflow

```yaml
# Complete changelog automation workflow
name: Release Automation

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Generate Changelog
        run: |
          # Install git-cliff
          wget https://github.com/orhun/git-cliff/releases/latest/download/git-cliff-x86_64-unknown-linux-gnu.tar.gz
          tar -xzf git-cliff-x86_64-unknown-linux-gnu.tar.gz
          chmod +x git-cliff

          # Generate changelog
          ./git-cliff --tag ${{ github.ref_name }} --prepend CHANGELOG.md
          ./git-cliff --latest --strip header --output RELEASE_NOTES.md

      - name: Commit Changelog
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add CHANGELOG.md
          git commit -m "docs: update CHANGELOG for ${{ github.ref_name }}" || true
          git push || true

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          body_path: RELEASE_NOTES.md
          files: |
            LICENSE
            README.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## Tools Comparison

### Choosing the Right Tool

**Use git-cliff if:**
- You need maximum flexibility
- You have complex commit patterns
- You want fast performance
- You prefer configuration files

**Use conventional-changelog if:**
- You're in a Node.js ecosystem
- You follow Angular commit style
- You want simple setup
- You need ecosystem integration

**Use GitHub's auto-generated notes if:**
- You use pull requests extensively
- You want minimal setup
- You label PRs consistently
- GitHub UI is sufficient

**Use semantic-release if:**
- You want full automation
- You need version bumping too
- You can adopt strict conventions
- You want zero manual intervention

## Resources

- [Keep a Changelog](https://keepachangelog.com/)
- [git-cliff Documentation](https://git-cliff.org/)
- [conventional-changelog](https://github.com/conventional-changelog/conventional-changelog)
- [Semantic Release](https://semantic-release.gitbook.io/)
- [GitHub Release Notes](https://docs.github.com/en/repositories/releasing-projects-on-github/automatically-generated-release-notes)

---

**Last Updated:** 2025-12-01
**Version:** 1.0
